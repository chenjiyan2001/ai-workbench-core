# 项目文档规范

本文档定义项目文档（README、使用指南、部署文档）的撰写规范。

---

## 核心原则

1. **用户导向**：按读者角色组织内容，而非按技术模块
2. **快速上手**：30 秒看懂项目干什么，5 分钟能跑起来
3. **示例可运行**：代码示例可直接复制执行
4. **保持同步**：代码变更时同步更新文档
5. **渐进式详细**：概述 → 快速开始 → 详细文档

---

## README 规范

### 标准结构

~~~markdown
# 项目名称

> 一句话描述项目用途（不超过 20 字）

简要介绍项目背景和解决的问题（2-3 句话）

## 特性

- 核心功能点 1
- 核心功能点 2
- 核心功能点 3

## 快速开始

最简安装和运行示例（目标：30 秒内能跑起来）

## 安装

详细安装步骤

## 使用

基本用法和代码示例

## 配置

配置项说明

## 文档

- [使用指南](docs/usage.md)
- [部署文档](docs/deployment.md)
- [API 文档](docs/api.md)

## 贡献

如何参与贡献

## License

开源协议
~~~

### 各章节要求

#### 项目标题和描述

```markdown
# AI Workbench

> 数据处理平台的开发规范与架构文档库

本仓库存放数据处理平台的开发规范，涵盖 Git、Python、数据库、LLM 调用等方面，
供团队成员和 Claude 在协作开发时参考遵循。
```

**要求：**
- 标题简洁，体现项目核心
- 一句话描述不超过 20 字
- 背景介绍 2-3 句话，说明解决什么问题

#### 快速开始

```markdown
## 快速开始

### 环境要求

- Python 3.11+
- MySQL 8.0+

### 安装

```bash
pip install ai-workbench
```

### 运行

```python
from ai_workbench import DataProcessor

processor = DataProcessor()
result = processor.run()
print(result)
```
```

**要求：**
- 最小依赖，最简步骤
- 代码可直接复制运行
- 不超过 10 行命令/代码

#### 配置说明

```markdown
## 配置

### 环境变量

| 变量名 | 必填 | 默认值 | 说明 |
|--------|------|--------|------|
| `DATABASE_URL` | 是 | - | 数据库连接字符串 |
| `REDIS_URL` | 否 | `redis://localhost` | Redis 连接地址 |
| `LOG_LEVEL` | 否 | `INFO` | 日志级别 |

### 配置文件示例

```yaml
database:
  host: localhost
  port: 3306
  name: mydb

redis:
  url: redis://localhost:6379
```
```

**要求：**
- 必填/选填明确标注
- 提供默认值
- 给出完整配置示例

---

## 使用指南规范

### 结构

```markdown
# 使用指南

## 概述
本指南面向 xxx 用户，介绍如何使用 xxx 功能。

## 前置条件
- 已完成安装
- 已配置 xxx

## 基本用法
### 场景一：xxx
### 场景二：xxx

## 高级用法
### 批量处理
### 自定义配置

## 常见问题
### Q: xxx？
A: xxx

## 下一步
- [API 文档](api.md)
- [部署指南](deployment.md)
```

### 写作要求

| 要求 | 说明 |
|------|------|
| 面向场景 | 按"我要做什么"组织，而非按"有什么功能" |
| 步骤清晰 | 使用有序列表，每步一个动作 |
| 结果可验证 | 说明预期结果，方便用户确认 |
| 错误处理 | 常见错误和解决方法 |

### 示例

```markdown
### 导出用户数据

1. 登录管理后台

2. 进入"用户管理"页面

3. 点击"导出"按钮，选择格式：
   - CSV：适合 Excel 打开
   - JSON：适合程序处理

4. 等待导出完成，文件自动下载

**预期结果**：下载得到 `users_20231201.csv` 文件

**常见问题**：
- 导出超时：数据量大时请分批导出
- 文件乱码：使用 UTF-8 编码打开
```

---

## 部署文档规范

### 结构

```markdown
# 部署指南

## 环境要求
### 硬件要求
### 软件依赖

## 兼容性
### 浏览器兼容性（前端项目）
### 系统兼容性
### 依赖版本兼容

## 部署方式
### Docker 部署（推荐）
### 手动部署

## 配置
### 必要配置
### 可选配置

## 启动
### 启动命令
### 健康检查

## 安全配置
### 网络安全
### 认证授权
### 敏感信息处理

## 监控
### 日志位置
### 指标监控
### 告警配置

## 运维
### 备份恢复
### 扩缩容
### 升级与回滚
### 故障排查
```

### 各章节要求

#### 环境要求

```markdown
## 环境要求

### 硬件要求

| 配置 | 最低要求 | 推荐配置 |
|------|---------|---------|
| CPU | 2 核 | 4 核+ |
| 内存 | 4 GB | 8 GB+ |
| 磁盘 | 20 GB | 50 GB+ SSD |

### 软件依赖

| 软件 | 版本要求 | 说明 |
|------|---------|------|
| Docker | 20.10+ | 容器运行时 |
| Python | 3.11+ | 仅手动部署需要 |
| MySQL | 8.0+ | 数据库 |
```

#### 部署步骤

```markdown
## Docker 部署

### 1. 拉取镜像

```bash
docker pull myregistry/ai-workbench:latest
```

### 2. 准备配置

```bash
cp config.example.yaml config.yaml
# 编辑 config.yaml，填写数据库连接等配置
```

### 3. 启动容器

```bash
docker run -d \
  --name ai-workbench \
  -p 8080:8080 \
  -v $(pwd)/config.yaml:/app/config.yaml \
  myregistry/ai-workbench:latest
```

### 4. 验证部署

```bash
curl http://localhost:8080/health
# 预期返回: {"status": "ok"}
```
```

#### 故障排查

```markdown
## 故障排查

### 服务无法启动

**现象**：容器启动后立即退出

**排查步骤**：

1. 查看日志
   ```bash
   docker logs ai-workbench
   ```

2. 常见原因：
   - 配置文件格式错误
   - 数据库连接失败
   - 端口被占用

3. 解决方法：
   - 检查 config.yaml 语法
   - 确认数据库可连接
   - 更换端口或释放占用
```

#### 安全配置

```markdown
## 安全配置

### 网络安全

- 使用 HTTPS，禁用 HTTP（生产环境）
- 配置防火墙，仅开放必要端口
- 使用反向代理（Nginx/Traefik）

### 认证授权

- 启用 JWT 或 OAuth2 认证
- 配置 CORS 白名单
- API 限流配置

### 敏感信息处理

| 信息类型 | 存储方式 | 传输方式 |
|---------|---------|---------|
| 密码 | bcrypt 哈希 | 禁止明文 |
| API Key | 环境变量 | HTTPS |
| 数据库密码 | Secret 管理 | 加密连接 |

> ⚠️ 禁止在代码或配置文件中硬编码敏感信息
```

#### 升级与回滚

```markdown
## 升级与回滚

### 升级步骤

1. 备份当前版本
   ```bash
   docker tag myapp:latest myapp:backup-$(date +%Y%m%d)
   ```

2. 拉取新版本
   ```bash
   docker pull myregistry/myapp:v2.0.0
   ```

3. 停止旧服务，启动新服务
   ```bash
   docker stop myapp && docker run -d --name myapp myregistry/myapp:v2.0.0
   ```

4. 验证服务正常
   ```bash
   curl http://localhost:8080/health
   ```

### 回滚步骤

如升级后出现问题，执行回滚：

```bash
docker stop myapp
docker run -d --name myapp myapp:backup-20250118
```

### 数据库迁移

- 升级前执行 `migrate up`
- 回滚时执行 `migrate down`
- 保留迁移脚本的回滚功能
```

---

## 文档类型对照

| 文档类型 | 目标读者 | 核心内容 | 更新频率 |
|---------|---------|---------|---------|
| README | 所有人 | 项目概述、快速开始 | 功能变更时 |
| 使用指南 | 终端用户 | 功能用法、场景示例 | 功能变更时 |
| 部署文档 | 运维人员 | 环境、部署、监控 | 架构变更时 |
| 开发指南 | 开发者 | 架构、规范、贡献 | 规范变更时 |
| API 文档 | 集成方 | 接口、参数、示例 | 接口变更时 |

---

## 写作规范

### 语言风格

| 规范 | 正确示例 | 错误示例 |
|------|---------|---------|
| 使用主动语态 | "点击按钮" | "按钮应被点击" |
| 使用祈使句 | "配置数据库连接" | "你需要配置数据库连接" |
| 简洁明了 | "运行命令" | "接下来我们需要运行以下命令" |
| 避免术语堆砌 | "保存到数据库" | "持久化到 RDBMS 存储层" |

### 代码示例要求

```
✅ 正确：
├── 可直接复制运行
├── 包含必要的 import
├── 有预期输出说明
├── 错误处理示例（如需要）
└── 注释说明关键步骤

❌ 错误：
├── 省略 import 语句
├── 使用 ... 省略关键代码
├── 硬编码敏感信息
├── 依赖未说明的前置条件
└── 没有预期结果说明
```

### 格式规范

| 元素 | 格式 |
|------|------|
| 文件路径 | `config/settings.yaml` |
| 命令 | `pip install xxx` |
| 代码/变量 | `DATABASE_URL` |
| 按钮/菜单 | "保存"按钮、"文件"菜单 |
| 强调 | **重要内容** |
| 警告 | > ⚠️ 注意：xxx |

---

## 检查清单

### README 检查

- [ ] 一句话描述清晰准确
- [ ] 快速开始可在 5 分钟内完成
- [ ] 代码示例可直接运行
- [ ] 配置项有说明和默认值
- [ ] 文档链接有效

### 使用指南检查

- [ ] 面向场景组织内容
- [ ] 步骤清晰，每步一个动作
- [ ] 有预期结果说明
- [ ] 常见问题有解答

### 部署文档检查

- [ ] 环境要求明确（最低/推荐）
- [ ] 部署步骤可重复执行
- [ ] 有健康检查方法
- [ ] 有故障排查指南
